{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{useSearchParams,useNavigate}from'react-router-dom';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const VerifyEmailPage=()=>{const[searchParams]=useSearchParams();const navigate=useNavigate();const hasRunRef=useRef(false);const[status,setStatus]=useState('pending');const[message,setMessage]=useState('');useEffect(()=>{if(hasRunRef.current)return;hasRunRef.current=true;const token=searchParams.get('token');console.log('Verification token from URL:',token);if(!token){setStatus('error');setMessage('Invalid or missing token.');return;}const verifyEmail=async()=>{try{const response=await fetch(\"/VerifyUser?token=\".concat(encodeURIComponent(token)));const contentType=response.headers.get('content-type');let responseText='';if(contentType!==null&&contentType!==void 0&&contentType.includes('application/json')){const data=await response.json();responseText=data.message||'';}else{responseText=await response.text();}if(response.ok){setStatus('success');setMessage(responseText||'Your email has been successfully verified!');}else{console.error('Verification failed response:',responseText);setStatus('error');setMessage(responseText||'Verification failed.');}}catch(err){console.error('Verification error:',err);setStatus('error');setMessage('An error occurred during verification.');}};verifyEmail();},[searchParams]);return/*#__PURE__*/_jsx(\"div\",{className:\"container mt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card shadow p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body text-center\",children:[status==='pending'&&/*#__PURE__*/_jsx(\"p\",{children:\"Verifying your email...\"}),status==='success'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success\",children:message}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary mt-3\",onClick:()=>navigate('/login'),children:\"Go to Login\"})]}),status==='error'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:message}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary mt-3\",onClick:()=>navigate('/login'),children:\"Back to Login\"})]})]})})});};export default VerifyEmailPage;","map":{"version":3,"names":["React","useEffect","useRef","useState","useSearchParams","useNavigate","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","VerifyEmailPage","searchParams","navigate","hasRunRef","status","setStatus","message","setMessage","current","token","get","console","log","verifyEmail","response","fetch","concat","encodeURIComponent","contentType","headers","responseText","includes","data","json","text","ok","error","err","className","children","onClick"],"sources":["/Users/jaili/csharpProject/Prototype/Prototype/ClientApp/src/components/account/VerifyEmailPage.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { useSearchParams, useNavigate } from 'react-router-dom';\n\nconst VerifyEmailPage: React.FC = () => {\n    const [searchParams] = useSearchParams();\n    const navigate = useNavigate();\n    const hasRunRef = useRef(false);\n\n    const [status, setStatus] = useState<'pending' | 'success' | 'error'>('pending');\n    const [message, setMessage] = useState('');\n\n    useEffect(() => {\n        if (hasRunRef.current) return;\n        hasRunRef.current = true;\n\n        const token = searchParams.get('token');\n        console.log('Verification token from URL:', token);\n\n        if (!token) {\n            setStatus('error');\n            setMessage('Invalid or missing token.');\n            return;\n        }\n\n        const verifyEmail = async () => {\n            try {\n                const response = await fetch(`/VerifyUser?token=${encodeURIComponent(token)}`);\n\n                const contentType = response.headers.get('content-type');\n                let responseText = '';\n\n                if (contentType?.includes('application/json')) {\n                    const data = await response.json();\n                    responseText = data.message || '';\n                } else {\n                    responseText = await response.text();\n                }\n\n                if (response.ok) {\n                    setStatus('success');\n                    setMessage(responseText || 'Your email has been successfully verified!');\n                } else {\n                    console.error('Verification failed response:', responseText);\n                    setStatus('error');\n                    setMessage(responseText || 'Verification failed.');\n                }\n            } catch (err) {\n                console.error('Verification error:', err);\n                setStatus('error');\n                setMessage('An error occurred during verification.');\n            }\n        };\n\n        verifyEmail();\n    }, [searchParams]);\n\n    return (\n        <div className=\"container mt-5\">\n            <div className=\"card shadow p-4\">\n                <div className=\"card-body text-center\">\n                    {status === 'pending' && <p>Verifying your email...</p>}\n\n                    {status === 'success' && (\n                        <>\n                            <div className=\"alert alert-success\">{message}</div>\n                            <button className=\"btn btn-primary mt-3\" onClick={() => navigate('/login')}>\n                                Go to Login\n                            </button>\n                        </>\n                    )}\n\n                    {status === 'error' && (\n                        <>\n                            <div className=\"alert alert-danger\">{message}</div>\n                            <button className=\"btn btn-secondary mt-3\" onClick={() => navigate('/login')}>\n                                Back to Login\n                            </button>\n                        </>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default VerifyEmailPage;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CAC1D,OAASC,eAAe,CAAEC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,QAAA,IAAAC,SAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEhE,KAAM,CAAAC,eAAyB,CAAGA,CAAA,GAAM,CACpC,KAAM,CAACC,YAAY,CAAC,CAAGT,eAAe,CAAC,CAAC,CACxC,KAAM,CAAAU,QAAQ,CAAGT,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAU,SAAS,CAAGb,MAAM,CAAC,KAAK,CAAC,CAE/B,KAAM,CAACc,MAAM,CAAEC,SAAS,CAAC,CAAGd,QAAQ,CAAkC,SAAS,CAAC,CAChF,KAAM,CAACe,OAAO,CAAEC,UAAU,CAAC,CAAGhB,QAAQ,CAAC,EAAE,CAAC,CAE1CF,SAAS,CAAC,IAAM,CACZ,GAAIc,SAAS,CAACK,OAAO,CAAE,OACvBL,SAAS,CAACK,OAAO,CAAG,IAAI,CAExB,KAAM,CAAAC,KAAK,CAAGR,YAAY,CAACS,GAAG,CAAC,OAAO,CAAC,CACvCC,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAEH,KAAK,CAAC,CAElD,GAAI,CAACA,KAAK,CAAE,CACRJ,SAAS,CAAC,OAAO,CAAC,CAClBE,UAAU,CAAC,2BAA2B,CAAC,CACvC,OACJ,CAEA,KAAM,CAAAM,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,sBAAAC,MAAA,CAAsBC,kBAAkB,CAACR,KAAK,CAAC,CAAE,CAAC,CAE9E,KAAM,CAAAS,WAAW,CAAGJ,QAAQ,CAACK,OAAO,CAACT,GAAG,CAAC,cAAc,CAAC,CACxD,GAAI,CAAAU,YAAY,CAAG,EAAE,CAErB,GAAIF,WAAW,SAAXA,WAAW,WAAXA,WAAW,CAAEG,QAAQ,CAAC,kBAAkB,CAAC,CAAE,CAC3C,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAR,QAAQ,CAACS,IAAI,CAAC,CAAC,CAClCH,YAAY,CAAGE,IAAI,CAAChB,OAAO,EAAI,EAAE,CACrC,CAAC,IAAM,CACHc,YAAY,CAAG,KAAM,CAAAN,QAAQ,CAACU,IAAI,CAAC,CAAC,CACxC,CAEA,GAAIV,QAAQ,CAACW,EAAE,CAAE,CACbpB,SAAS,CAAC,SAAS,CAAC,CACpBE,UAAU,CAACa,YAAY,EAAI,4CAA4C,CAAC,CAC5E,CAAC,IAAM,CACHT,OAAO,CAACe,KAAK,CAAC,+BAA+B,CAAEN,YAAY,CAAC,CAC5Df,SAAS,CAAC,OAAO,CAAC,CAClBE,UAAU,CAACa,YAAY,EAAI,sBAAsB,CAAC,CACtD,CACJ,CAAE,MAAOO,GAAG,CAAE,CACVhB,OAAO,CAACe,KAAK,CAAC,qBAAqB,CAAEC,GAAG,CAAC,CACzCtB,SAAS,CAAC,OAAO,CAAC,CAClBE,UAAU,CAAC,wCAAwC,CAAC,CACxD,CACJ,CAAC,CAEDM,WAAW,CAAC,CAAC,CACjB,CAAC,CAAE,CAACZ,YAAY,CAAC,CAAC,CAElB,mBACIN,IAAA,QAAKiC,SAAS,CAAC,gBAAgB,CAAAC,QAAA,cAC3BlC,IAAA,QAAKiC,SAAS,CAAC,iBAAiB,CAAAC,QAAA,cAC5B9B,KAAA,QAAK6B,SAAS,CAAC,uBAAuB,CAAAC,QAAA,EACjCzB,MAAM,GAAK,SAAS,eAAIT,IAAA,MAAAkC,QAAA,CAAG,yBAAuB,CAAG,CAAC,CAEtDzB,MAAM,GAAK,SAAS,eACjBL,KAAA,CAAAF,SAAA,EAAAgC,QAAA,eACIlC,IAAA,QAAKiC,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAEvB,OAAO,CAAM,CAAC,cACpDX,IAAA,WAAQiC,SAAS,CAAC,sBAAsB,CAACE,OAAO,CAAEA,CAAA,GAAM5B,QAAQ,CAAC,QAAQ,CAAE,CAAA2B,QAAA,CAAC,aAE5E,CAAQ,CAAC,EACX,CACL,CAEAzB,MAAM,GAAK,OAAO,eACfL,KAAA,CAAAF,SAAA,EAAAgC,QAAA,eACIlC,IAAA,QAAKiC,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAAEvB,OAAO,CAAM,CAAC,cACnDX,IAAA,WAAQiC,SAAS,CAAC,wBAAwB,CAACE,OAAO,CAAEA,CAAA,GAAM5B,QAAQ,CAAC,QAAQ,CAAE,CAAA2B,QAAA,CAAC,eAE9E,CAAQ,CAAC,EACX,CACL,EACA,CAAC,CACL,CAAC,CACL,CAAC,CAEd,CAAC,CAED,cAAe,CAAA7B,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}